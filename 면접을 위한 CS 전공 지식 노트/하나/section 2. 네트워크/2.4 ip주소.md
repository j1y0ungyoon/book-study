# 2.4 IP 주소

## 2.4.1 ARP, RARP

컴퓨터와 컴퓨터 간의 통신은 IP주소에서 ARP를 통해 MAC 주소를 찾아 MAC 주소를 기반으로 통신함

**ARP(address resolution protocol)**

- IP주소로부터 MAC 주소를 구하는 IP와 MAC 주소의 다리 역할을 하는 프로토콜
- 가상 주소인 IP(논리적 주소)를 실제 주소인 MAC 주소(물리적 주소)로 변환함
- 이와 반대로 RARP를 통해 실제 주소인 MAC 주소(물리적 주소)를 가상 주소인 IP 주소(논리적 주소)로 변환할 수 있음

## 2.4.2 홉바이홉(Hop by hop) 통신

- IP 주소를 통해 통신하는 과정을 말함
- 통신 장비에 있는 라우팅 테이블*의 ip를 통해 시작 주소부터 시작해 다음 ip로 계속 이동하는 라우팅* 과정을 거쳐 패킷이 최종 목적지까지 도달하는 통신을 말함

\*라우팅
IP주소를 찾아가는 과정

\*라우팅 테이블

- 송신지에서 수신지까지 도달하기 위해 사용함
- 게이트웨이\*와 모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터의 정보를 가지고 있음

\*게이트웨이

- 서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터나 소프트웨어를 두루 일컫는 용어
- 서로 다른 네트워크상의 통신 프로토콜을 변환해주는 역할을 함
- 라우팅 테이블이나 netstat -r 명령어를 통해 게이트웨이 확인가능

## 2.4.3 IP 주소 체계

- IPv4 : 32비트를 8비트 단위로 점 찍어 표기
- IPv6 : 64비트를 16비트 단위로 점 찍어 표기
- IPv6로 가는 추세임

**책에는 IPv4를 기준으로 설명했음**

### 클래스 기반 할당 방식

<img src="https://velog.velcdn.com/images/sean2337/post/ca6e0356-7c5e-4ec7-9b0b-0935a9a04975/image.png" width="50%" height="50%">

- ip 주소 쳬계 A,B,C,D,E의 다섯 개의 클래스를 구분하는 클래스 기반 할당 방식 사용했음
- 클래스 A, B, C는 일대일 통신으로 사용됨, D는 멀티캐스트 통신, 클래스 E는 앞으로 사용할 예비용으로 쓰는 방식임

<img src="https://velog.velcdn.com/images/dlehdus97/post/ea858c19-f916-4717-abb7-3fd5d6642e61/image.png" width="50%" height="50%">

- 네트워크의 첫 번째 주소는 네트워크 주소로 사용되고, 마지막 주소는 브로드 캐스트용 주소로 네트워크에 속해있는 모든 컴퓨터에 데이터를 보낼 때 사용됨

#### 예시

12.0.0.0이라는 네트워크 받음 -> 12.0.0.1 ~ 12.255.255.254의 호스트 주소 부여받음 -> 첫 번째 주소는 네트워크 구별 주소이기 때문에 사용 x, 마지막 주소인 12.255.255.255의 경우도 브로드캐스트 용으로 남겨두어야 하기 때문에 사용x -> 첫 번째와 마지막 주소를 제외한 12.0.0.1 ~ 12.255.255.254를 호스트 주소로 사용 가능 -> 하지만 버리는 주소가 더 많은 단점이 있음 -> 이를 해소하기 위해 DHCP, IPv4, NAT이 등장함

### DHCP(dynamic host configuration protocol)

- IP주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜
- 인터넷에 접속할 때마다 자동으로 IP주소를 할당할 수 있음
- 많은 라우터와 게이트웨이 장비에 DHCP 기능이 있음 -> 이를 통해 대부분의 가정용 네트워크에서 IP 주소를 할당함

### NAT(network address transition)

<img src="https://velog.velcdn.com/images/sean2337/post/b55bc668-346e-48b6-89a9-89f76eff49c4/image.png" width="50%" height="50%">

- 패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP주소를 수정해 IP주소를 다른 주소로 매핑하는 방법
- IPv4 주소 체계로는 많은 주소를 감당 X
- 이를 해결하기 위해 NAT로 공인 IP와 사설 IP로 나누어 많은 주소 처리
- NAT 장치를 통해 사설 IP를 공인 IP로 변환하거나 공인 IP를 사설 IP로 변환하는데 사용

#### 공유기와 NAT

NAT를 사용하는 이유는 주로 여러 대의 호스트가 하나의 공인 IP 주소를 사용해 인터넷에 접속하기 위함임

- NAT를 이용한 보안
  NAT를 사용하면 내부 네트워크에서 사용하는 IP주소와 외부에 드러나는 IP주소를 다르게 유지할 수 있기 때문에 내부 네트워크에 대한 어느 정도 보안이 가능함

- NAT의 단점
  여러 명이 동시에 인터넷을 접속하게 되므로 실제로 접속하는 호스트의 숫자에 따라 접속 속도가 느려질 수 있음

## 2.4.4 IP 주소를 이용한 위치 정보

IP주소는 인터넷에서 사용하는 네트워크 주소이기 때문에 이를 통해 동이나 구까지 위치 추적이 가능함
